/*! Nova Gallery - HTML5 Multimedia Gallery - 1.4.1
 * Copyright 2013, Nilok Bose
 * http://codecanyon.net/user/cosmocoder
*/
!function(e,i,t){"use strict";var l={init:function(l){if(this.config=l,this.$novaGallery=e("#novaGallery"),this.$gallerySets=e("#novaGallerySets"),this.$galleryWrapper=e("#novaGalleryWrapper"),this.$filterButtons=e("#filterButtons"),this.$thumbGrid=e("#novaThumbGrid"),this.$captionTest=e('<div id="captionTest"/>').appendTo("body"),this.$mask=e('<div id="thumbMask"/>').appendTo(this.$novaGallery),this.$overlayLoader=e('<div id="thumbOverlayLoader"/>').appendTo(this.$novaGallery),this.$overlay=e('<div id="thumbOverlay"/>').appendTo(this.$novaGallery),this.$overlayContent=e('<div id="thumbOverlayContent"/>').appendTo(this.$overlay),this.$close=e('<a class="close"/>').appendTo(this.$overlay),this.$prevItem=e('<a class="prev-item"/>').appendTo(this.$overlay),this.$nextItem=e('<a class="next-item"/>').appendTo(this.$overlay),this.$fullGallery=e("#novaFull"),this.$fwmedia=this.$fullGallery.find("div.fwmedia"),this.$fwActiveItem=null,this.thumbMeElem=null,this.thumbPlayer=null,this.fwMeElem=null,this.fwplayer=null,this.$fwOverlay=e('<div id="fwOverlay"/>').appendTo(this.$novaGallery),this.$fwOverlayContent=e('<div id="fwOverlayContent"/>').appendTo(this.$fwOverlay),this.displayType=this.options.displayType,this.startMode=this.options.startMode,this.autoplay=this.options.autoplay,this.loop=this.options.loop,this.storeVolume=this.options.storeVolume,this.fwResize=this.options.fullwidthResize,this.fwShowThumbs=this.options.showFullwidthThumbs,this.thumbAppearAnim=this.options.thumbnailsAppearAnimation,this.thumbCaptionAnim=this.options.thumbnailsCaptionAnimation,this.homescreenAnim=this.options.homescreenAnimation,this.preloadNumber=this.options.preloadNumber,this.slideshow=this.options.slideshow,this.pauseTime=this.options.pauseTime,this.fwClock=null,this.volume=null,this.itemnum=0,this.thumbIndex=0,this.fwIndex=0,this.touchStartPos=0,this.touchEndPos=0,this.$window=e(t),this.easing=Modernizr.csstransitions?"in-out":"swing",this.filterSpeed=600,this.fwmediaSpeed=400,this.html5FS=!1,this.isChrome=null!==navigator.userAgent.match(/chrome/gi),this.isSafari=null!==navigator.userAgent.match(/webkit/gi)&&!this.isChrome,this.isOpera=null!==navigator.userAgent.match(/opera/gi),this.isiOS=null!==navigator.userAgent.match(/(iPad|iPhone|iPod)/gi),this.isAndroid=null!==navigator.userAgent.match(/android/i),this.msie=-1!=navigator.appName.toLowerCase().indexOf("microsoft"),this.isIE9=this.msie&&9==parseFloat(navigator.appVersion.split("MSIE")[1],10),this.ie9js=this.msie&&t.IE7&&IE7.recalc?!0:!1,this.hasTouch="ontouchstart"in t,this.$overlayContent.html('<div class="details"><h2></h2><p></p></div>'),this.$otitle=this.$overlayContent.find("h2"),this.$odescription=this.$overlayContent.find("p"),this.$fwOverlay.append('<a class="close"/>'),Modernizr.csstransforms3d&&"flip"===this.thumbCaptionAnim?this.$thumbGrid.addClass("css3d"):this.thumbCaptionAnim="fade",Modernizr.csstransforms3d||"flipSeq"!==this.thumbAppearAnim?this.thumbAppearAnim:this.thumbAppearAnim="fadeSeq",!Modernizr.csstransitions&&(e.fn.transition=e.fn.animate),i.documentElement.requestFullscreen||i.documentElement.mozRequestFullScreen||i.documentElement.webkitRequestFullscreen||i.documentElement.msRequestFullscreen?this.html5FS=!0:e("#goFullscreen").hide(),this.hasTouch||(this.$filterButtons.addClass("no-touch"),this.$thumbGrid.addClass("no-touch"),this.$novaGallery.find("menu").addClass("no-touch")),0!==l.find("gallery").length){var a=this;this.createGallerySets(l),this.$gallerySets.addClass("hidden"),this.$gallerySets.imagesLoaded(function(){a.$gallerySets.removeClass("hidden"),a.$novaGallery.css({background:"none",height:"auto"}),a.$gallerySets.fadeIn(400,function(){t.PIE&&a.$gallerySets.find("img, span.number").each(function(){t.PIE.attach(this)})})})}else e("#gotoSets").hide(),this.$galleryWrapper.show(),this.showGallery();this.bindEvents()},loadConfig:function(i){e.ajax({type:"GET",url:i,dataType:"xml",global:!1,success:function(i){if(l.options.useVimeoThumbs){var t,a,s=e(i),n=[];s.find('file[type="video"]').find("source").filter(function(){return-1!==e(this).text().indexOf("vimeo")}).each(function(){var l=e(this);t=l.text().split("/").pop(),a=e.ajax({url:"https://vimeo.com/api/v2/video/"+t+".json",dataType:"jsonp",success:function(e){var t=i.createElement("thumbnail");t.appendChild(i.createTextNode(e[0].thumbnail_medium)),l.before(t)}}),n.push(a)}),e.when.apply(e,n).done(function(){l.init(s)})}else l.init(e(i))}})},loadFlickrData:function(i){var t=l,a="url_"+i.thumbSize,s="url_"+i.imageSize,n="",o="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+i.apiKey+"&per_page="+i.limit+"&sort="+i.sort+"&extras=url_t,url_m,url_o,url_s,url_q,url_l,url_z,description";if("user"===i.sourceType?(o+="&user_id="+i.sourceId,n="flickr-user-"+i.sourceId):"group"===i.sourceType?(o+="&group_id="+i.sourceId,n="flickr-group-"+i.sourceId):"set"===i.sourceType?(o="https://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos&api_key="+i.apiKey+"&photoset_id="+i.sourceId+"&per_page="+i.limit+"&sort="+i.sort+"&extras=url_t,url_m,url_o,url_s,url_q,url_l,url_z,description",n="flickr-set-"+i.sourceId):"tags"===i.sourceType?(o+="&tags="+i.sourceId,n="flickr-tags-"+i.sourceId):"text"===i.sourceType&&(o+="&text="+i.sourceId,n="flickr-text-"+i.sourceId),t.options.enableCache)var r=t.getCache(n);else{var r=e.Deferred();r.resolve()}r.done(function(i){var r=e(i);i&&"expired"!==r.find("novaGallery").attr("status")?l.init(r):e.ajax({url:o,dataType:"xml",global:!1,success:function(i){var o,r=e(i),d="<novagallery>",h="";"ok"===r.find("rsp").attr("stat")&&"0"!==r.find("photos").attr("total")?(h=t.createFlickrSetXML(r.find("photo"),s,a),d+=h+"</novagallery>",o=e(e.parseXML(d)),l.options.enableCache&&l.updateCache(d,n),l.init(o)):t.ngLog("0"===r.find("photos").attr("total")?"Flickr: No photos found":"Flickr: "+r.find("err").attr("msg"))}})})},loadFlickrCollection:function(i){var t=l,a="url_"+i.thumbSize,s="url_"+i.imageSize,n="flickr-collection"+i.sourceId+"-user-"+i.userId,o="https://api.flickr.com/services/rest/?method=flickr.collections.getTree&api_key="+i.apiKey,r="https://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos&api_key="+i.apiKey+"&per_page="+i.limit+"&sort="+i.sort+"&extras=url_t,url_m,url_o,url_s,url_q,url_l,url_z,description",d="all"===i.numberOfAlbums?"":i.numberOfAlbums;if(""!==i.sourceId&&(o+="&collection_id="+i.sourceId),""!==i.userId&&(o+="&user_id="+i.userId),t.options.enableCache)var h=t.getCache(n);else{var h=e.Deferred();h.resolve()}h.done(function(i){var h=e(i);i&&"expired"!==h.find("novaGallery").attr("status")?l.init(h):e.ajax({url:o,dataType:"xml",global:!1,success:function(i){var o=e(i),h=[],u=[];"ok"===o.find("rsp").attr("stat")?o.find("set").each(function(i){var l=e(this).attr("id"),n=e(this).attr("title"),o=e.ajax({url:r+"&photoset_id="+l,dataType:"xml",success:function(i){var l=e(i),o='<gallery title="'+n+'">',r="";"ok"===l.find("rsp").attr("stat")?(r=t.createFlickrSetXML(l.find("photo"),s,a),o+=r+"</gallery>",u.push(o)):t.ngLog("Flickr: "+l.find("err").attr("msg"))}});return h.push(o),i===d-1?!1:void 0}):t.ngLog("Flickr: "+o.find("err").attr("msg")),e.when.apply(e,h).done(function(){var i="<novagallery>"+u.join("")+"</novagallery>",t=e(e.parseXML(i));l.options.enableCache&&l.updateCache(i,n),l.init(t)})}})})},createFlickrSetXML:function(i,t,l){var a,s,n="";return i.each(function(){s=e(this),a=s.attr(s.attr(t)?t:"url_o"),a=a?a:s.attr("url_z"),a=a?a:s.attr("url_m"),n+='<file type="photo">',n+="<thumbnail>"+s.attr(l)+"</thumbnail>",n+="<source>"+a+"</source>",n+="<title><![CDATA["+s.attr("title")+"]]></title>",n+="<description><![CDATA["+s.find("description").text()+"]]></description>",n+="</file>"}),n},loadPicasaData:function(i){var t=l,a="",s="https://picasaweb.google.com/data/feed/api/",n="all"===i.numberOfAlbums?1e3:i.numberOfAlbums;if("search"===i.sourceType?(s+="all?q="+i.search+"&callback=?",a="picasa-search-"+i.search):"user"===i.sourceType?(s+="user/"+i.username+"?&callback=?",a="picasa-user-"+i.username):"album"===i.sourceType?(s+="user/"+i.username+"/album/"+i.album+"?&callback=?",a="picasa-album-"+i.album+"-user-"+i.username):"collection"===i.sourceType&&(s+="user/"+i.username+"?&callback=?",a="picasa-collection-user-"+i.username),t.options.enableCache)var o=t.getCache(a);else{var o=e.Deferred();o.resolve()}o.done(function(o){var r=e(o);o&&"expired"!==r.find("novaGallery").attr("status")?l.init(r):e.ajax({url:s,data:{kind:"collection"===i.sourceType?"album":"photo",access:"public","max-results":"collection"===i.sourceType?n:i.limit,thumbsize:i.thumbSize+"u",imgmax:i.imageSize+"u",fields:"collection"===i.sourceType?"entry(title,gphoto:name,gphoto:numphotos)":"entry(media:group(media:content,media:thumbnail,media:title,media:description))",alt:"json"},dataType:"json",timeout:5e3,global:!1,success:function(s){if(!s.feed.entry)return void t.ngLog("Picasa request failed");var n,o,r="<novagallery>",d="",h=[];"collection"===i.sourceType?e.each(s.feed.entry,function(){if(0!==this.gphoto$numphotos.$t){var t=this;o=e.ajax({url:"https://picasaweb.google.com/data/feed/api/user/"+i.username+"/album/"+this.gphoto$name.$t+"?&callback=?",data:{kind:"photo",access:"public","max-results":i.limit,thumbsize:i.thumbSize+"u",imgmax:i.imageSize+"u",fields:"entry(media:group(media:content,media:thumbnail,media:title,media:description))",alt:"json"},dataType:"json",global:!1,success:function(i){d+='<gallery title="'+e("<div/>").text(t.title.$t.replace(/"/g,"")).html()+'">',e.each(i.feed.entry,function(){d+='<file type="photo">',d+="<thumbnail>"+this.media$group.media$thumbnail[0].url+"</thumbnail>",d+="<source>"+this.media$group.media$content[0].url+"</source>",d+="<title><![CDATA["+this.media$group.media$title.$t+"]]></title>",d+="<description><![CDATA["+this.media$group.media$description.$t+"]]></description>",d+="</file>"}),d+="</gallery>"}}),h.push(o)}}):e.each(s.feed.entry,function(){d+='<file type="photo">',d+="<thumbnail>"+this.media$group.media$thumbnail[0].url+"</thumbnail>",d+="<source>"+this.media$group.media$content[0].url+"</source>",d+="<title><![CDATA["+this.media$group.media$title.$t+"]]></title>",d+="<description><![CDATA["+this.media$group.media$description.$t+"]]></description>",d+="</file>"}),e.when.apply(e,h).done(function(){r+=d+"</novagallery>",n=e(e.parseXML(r)),l.options.enableCache&&l.updateCache(r,a),l.init(n)})},complete:function(e,l){var a="";0===e.status&&("user"===i.sourceType?a+="user not found":"album"===i.sourceType&&(a+="user or album not found"),a="Picasa request failed"+(a?": "+a:"."),t.ngLog(a))}})})},getCache:function(i){var t=e.ajax({data:{cacheId:i,interval:l.options.cacheInterval},url:l.options.cacheFolder+"/get-cache.php",dataType:"xml",global:!1});return t},updateCache:function(i,t){e.ajax({type:"post",data:{config:i,cacheId:t},url:l.options.cacheFolder+"/update-cache.php",dataType:"xml",global:!1})},createGallerySets:function(e){for(var i,t=l,a=e.find("gallery"),s=a.length,n="",o=0;s>o;o++)i=a.eq(o).attr("thumbnail"),!i&&(i=a.eq(o).find("thumbnail").eq(0).text()),n+="<li>",n+="<figure>",n+='<img src="'+i+'">',n+="<figcaption>",n+='<span class="title">'+a.eq(o).attr("title")+"</span>",n+='<span class="number">'+a.eq(o).children().length+"</span>",n+="</figcaption>",n+="</figure>",n+="</li>";t.$gallerySets.children("ul").html(n)},getGallery:function(){var i=l,a=i.$gallerySets.find("li").index(e(this).closest("li"));i.$novaGallery.height(i.$novaGallery.height()),i.fwMeElem=null,i.fwplayer=null,t.mejs.players=[],Modernizr.csstransitions&&"scale"===i.homescreenAnim?(i.$novaGallery.css("overflow","hidden"),i.$gallerySets.addClass("scale scaleDown").on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){i.$novaGallery.css("overflow",""),i.$gallerySets.removeClass("scale scaleUp").hide().off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),i.$galleryWrapper.addClass("loading").fadeIn(600,function(){i.showGallery(a)})}),i.$gallerySets.redraw().addClass("scaleUp").removeClass("scaleDown")):"slide"===i.homescreenAnim?(i.$novaGallery.css("overflow","hidden"),i.$gallerySets.addClass("slide").transition({top:-i.$novaGallery.height()},600,i.easing,function(){i.$gallerySets.removeClass("slide").css({top:"",display:"none"}),i.$novaGallery.css("overflow",""),i.$galleryWrapper.addClass("loading").fadeIn(600,function(){i.showGallery(a)})})):i.$gallerySets.fadeOut(600,function(){i.$galleryWrapper.addClass("loading").fadeIn(600,function(){i.showGallery(a)})})},showGallery:function(i){var t=l,a=void 0!==i?t.config.find("gallery").eq(i):t.config;t.$thumbGrid.add(t.$fullGallery).addClass("hidden"),t.createGallery(a),t.fwmediaSpeed=0,t.setFWItem.call(t.$fullGallery.find("li")[0]),t.fwmediaSpeed=400,t.$novaGallery.imagesLoaded(function(){t.setThumbGrid(),t.$fwmedia.show(),t.$novaGallery.parent().addClass("parentHideOverflow"),t.setFullwidthSize(),t.$novaGallery.parent().removeClass("parentHideOverflow"),t.fwShowThumbs&&t.showFullwidthThumbs.call(t.$fullGallery.find("a.showThumbs")[0]),t.$thumbGrid.add(t.$fullGallery).removeClass("hidden"),t.$galleryWrapper.removeClass("loading"),t.$novaGallery.css({background:"none",height:"auto"}),t.ie9js&&IE7.recalc(),"fullwidth"===t.startMode?(t.$fullGallery.fadeIn(400),t.$novaGallery.find('a[data-mode="fullwidth"]').addClass("active").siblings().removeClass("active")):("flipSeq"===t.thumbAppearAnim||"slideSeq"===t.thumbAppearAnim||"fadeSeq"===t.thumbAppearAnim?(t.$thumbGrid.find("ul").addClass("play "+t.thumbAppearAnim),Modernizr.cssanimations?t.$thumbGrid.find("li").last().on("animationend webkitAnimationEnd oanimationend MSAnimationEnd",function(){e(this).parent().removeClass("play "+t.thumbAppearAnim).end().off("animationend webkitAnimationEnd oanimationend MSAnimationEnd")}):t.$thumbGrid.find("li.filtered").each(function(i){e(this).delay(200*i).css({opacity:0,marginTop:"slideSeq"===t.thumbAppearAnim?"-30px":0}).animate({opacity:1,marginTop:0},800,"linear")}),t.$thumbGrid.show()):"slide"===t.thumbAppearAnim?t.$thumbGrid.css({marginTop:"-30px",display:"block",opacity:0}).animate({marginTop:0,opacity:1},600):t.$thumbGrid.fadeIn(600),t.$novaGallery.find('a[data-mode="thumbnails"]').addClass("active").siblings().removeClass("active")),t.slideshow&&t.FWSlideshow.call(t.$fullGallery.find("a.slideshow")[0])})},createGallery:function(i){var t=l;t.$files=i.find("file"),t.itemnum=t.$files.length,t.options.shuffleItems&&(t.$files=e(t.shuffle(t.$files.get())));for(var a,s,n=t.$files.children("title"),o=t.$files.children("description"),r="",d="",h=0;h<t.itemnum;h++){a=t.$files.eq(h).find("category"),s='{"category": false}',0!==a.length&&(s="{",a.each(function(){s+='"'+e(this).text()+'": true,'}),s=s.substr(0,s.length-1),s+="}");var u=t.$files.eq(h),f=u.attr("type"),c=u.find("source"),m=u.find("thumbnail").text(),p=t.$files.eq(h).find("link").text(),v=p?" linkItem":"",y="",w=this.options.alwaysShowThumbTitle?"visible":"";if("video"===f&&t.options.useYoutubeThumbs&&-1!==c.text().indexOf("youtube")){var g=c.text().split("v=")[1];m="https://img.youtube.com/vi/"+g+"/mqdefault.jpg"}p&&(y=t.options.newWindowLinks?'<a class="link" href="'+p+'" target="_blank"></a>':'<a class="link" href="'+p+'"></a>'),r+='<li class="filtered'+v+'" data-id="'+h+'" data-type="'+f+"\" data-categories='"+s+"'>",r+="<figure>",r+='<img src="'+m+'" alt="" />',r+="<figcaption>",r+="<h2>"+n.eq(h).text()+"</h2>",r+='<div class="details">'+o.eq(h).text()+"</div>",r+="</figcaption>",r+="</figure>",r+='<div class="hoverTitle '+w+'">'+n.eq(h).text()+"</div>",r+='<a class="showInfo"></a>',r+='<a class="showOverlay"></a>',r+=y,d+='<li class="filtered" data-id="'+h+'" data-type="'+f+"\" data-categories='"+s+"'>",d+='<img src="'+m+'" alt="" />',d+="</li>"}t.$thumbGrid.find("ul").html(r),t.$fullGallery.find("ul").html(d),t.fwResize&&t.$fullGallery.find("a.resize").addClass("collapsed")},setThumbGrid:function(){for(var i,t=this,l=t.$thumbGrid.children("ul"),a=t.$thumbGrid.find("figure > img"),s=a.length,n=0,o=0;s>o;o++)0===o&&(n=a[o].width),a[o].width<n&&(n=a[o].width);for(var o=0;s>o;o++)i=n*Math.floor(a[o].width/n),a[o].width=i,a.eq(o).parent().add(a.eq(o).closest("li")).css({width:i,height:a[o].height});l.hasClass("masonry")&&l.masonry("destroy");var r=l.children("li").eq(0),d=n+parseInt(r.css("marginRight"),10)+parseInt(r.css("marginLeft"),10);t.filterSpeed=0,t.$thumbGrid.addClass("setCategory"),l.masonry({isAnimated:!Modernizr.csstransitions,animationOptions:{duration:600,easing:"swing",queue:!1},isFitWidth:!0,columnWidth:d,itemSelector:".filtered"}),l.masonry("option","duration",t.filterSpeed),t.handleMenu.call(e("#filterButtons").find("a.startCategory")[0]),t.$thumbGrid.removeClass("setCategory"),t.filterSpeed=600,l.masonry("option","duration",t.filterSpeed),Modernizr.cssanimations&&l.find("li.filtered").each(function(i){e(this).css({"-webkit-animation-delay":200*i+"ms","-moz-animation-delay":200*i+"ms","-o-animation-delay":200*i+"ms","-ms-animation-delay":200*i+"ms","animation-delay":200*i+"ms"})})},shuffle:function(e){for(var i,t,l=e.length;l;i=parseInt(Math.random()*l,10),t=e[--l],e[l]=e[i],e[i]=t);return e},bindEvents:function(){if(this.$novaGallery.find("menu").on("click","a",this.handleMenu),this.$novaGallery.find("menu").on("touchstart",function(i){i.stopPropagation(),e(this).addClass("hover")}),this.$filterButtons.on("touchstart",function(e){e.stopPropagation(),l.$filterButtons.addClass("hover")}),e(i).on("touchstart",function(e){l.$filterButtons.removeClass("hover").closest("menu").removeClass("hover")}),this.$gallerySets.on("click","img",this.getGallery),this.$thumbGrid.on("touchstart","li",function(){e(this).addClass("hover").siblings().removeClass("hover")}),this.$thumbGrid.on("click","a.showInfo",this.thumbGridCaptions),this.$thumbGrid.on("click","a.showOverlay",this.overlayCreate),this.$prevItem.click(this.overlayPrev),this.$nextItem.click(this.overlayNext),this.$close.click(this.overlayClose),this.$window.on("resize orientationchange fullscreenchange mozfullscreenchange webkitfullscreenchange msfullscreenchange",this.setFullwidthSize),this.$fullGallery.find("a.showThumbs").click(this.showFullwidthThumbs),this.$fullGallery.on("click","li",this.setFWItem),this.$fullGallery.find("a.slide-next").click(this.thumbnailsSlideNext),this.$fullGallery.find("a.slide-prev").click(this.thumbnailsSlidePrev),this.$fullGallery.find("ul").on("touchstart touchmove touchend",this.touchSlide),this.$fullGallery.find("a.slideshow").click(this.FWSlideshow),this.$fullGallery.find("a.next").click(this.showNextFWItem),this.$fullGallery.find("a.prev").click(this.showPrevFWItem),this.$fullGallery.find("a.info").click(this.showFWCaption),this.$fwOverlay.find("a.close").click(this.closeFWCaption),this.$fullGallery.find("a.resize").click(this.resizeFWItem),this.html5FS&&e(i).on("click","div.mejs-fullscreen-button",this.nativeMEFS),this.isOpera&&(this.$fwmedia.on("click","div.mejs-fullscreen-button",this.operaMEFS),e(i).keydown(this.operaEscPlayerFS)),e(i).keydown(this.handleKeys),this.options.stopSlideshowOnPageHide){var a=this.getHiddenProp();if(a){var s=a.replace(/[H|h]idden/,"")+"visibilitychange";i.addEventListener(s,this.pageVisChange)}}var n;e(t).on("scroll",function(){clearTimeout(n),e("body").addClass("disable-scroll"),n=setTimeout(function(){e("body").removeClass("disable-scroll")},500)}),"container"===this.displayType&&this.$window.on("resize",function(){l.$novaGallery.parent().width()<=684?l.$novaGallery.addClass("small"):l.$novaGallery.removeClass("small")}).trigger("resize")},thumbGridCaptions:function(){var i=l,t=e(this),a=t.parent(),s=a.children("figure"),n=a.find("figcaption"),o=a.find("img"),r=a.children("div.hoverTitle"),d=0,h="container"===i.displayType?i.$novaGallery.parent():i.$window,u=o[0].width,f=o[0].height,c=u,m=f,p=600,v=600;i.$captionTest.empty().html(n.html()),c=parseInt(i.$captionTest.css("width"),10),m=parseInt(i.$captionTest.css("height"),10),u>c&&(c=u),f>m&&(m=f),d=c>u?u-c:d,v=c===u&&m===f?0:v,a.data("expansionDuration",v),i.closeThumbCaption(a.siblings("li.captionOn")),a.hasClass("captionOn")?i.closeThumbCaption(a):(a.addClass("captionOn"),a.offset().left+c>h.width()?(s.add(n).removeClass("fixedLeft").addClass("fixedRight"),d=0,a.offset().left-(c-u)<=0&&(c=u)):s.add(n).removeClass("fixedRight").addClass("fixedLeft"),t.addClass("hidden").css("right",d),r.addClass("hidden"),"flip"===i.thumbCaptionAnim?(a.addClass("flip"),setTimeout(function(){s.addClass("hideOverflow"),s.add(n).css({width:c,height:m}),setTimeout(function(){t.removeClass("hidden"),n.css("overflow","auto")},v)},p)):(s.addClass("hideOverflow"),o.fadeOut(600),n.css({width:c,height:m}).fadeIn(600),s.transition({width:c,height:m},v,i.easing),t.removeClass("hidden"),n.css("overflow","auto")))},closeThumbCaption:function(e){if(0===e.length)return!1;var i=e.children("figure"),t=i.children("figcaption"),a=e.find("img"),s=e.children("a.showInfo"),n=e.children("div.hoverTitle"),o=e.data("expansionDuration");s.addClass("hidden").css("right","0"),t.css("overflow",""),"flip"===l.thumbCaptionAnim?(i.css({width:a[0].width,height:a[0].height}),setTimeout(function(){i.removeClass("hideOverflow"),i.children("figcaption").css({width:a[0].width,height:a[0].height}),e.redraw().removeClass("captionOn flip"),setTimeout(function(){s.add(n).removeClass("hidden")},600)},o)):(i.transition({width:a[0].width,height:a[0].height},o,self.easing),i.children("figcaption").fadeOut(600),a.fadeIn(600,function(){e.removeClass("captionOn"),s.add(n).removeClass("hidden")}))},handleMenu:function(){var t=l,a=e(this),s=t.$galleryWrapper.children("div.displayStyle"),n=t.$thumbGrid.find("li"),o=t.$fullGallery.find("li"),r=a.data("mode"),d=a.data("type"),h=a.data("category");if("gotoSets"===this.id)a.removeClass("active"),t.fwMeElem&&t.fwMeElem.pause(),Modernizr.csstransitions&&"scale"===t.homescreenAnim?(t.$novaGallery.css({height:t.$novaGallery.height(),overflow:"hidden"}),t.$galleryWrapper.addClass("scale scaleUp"),t.$gallerySets.addClass("scale scaleUp").show(),t.$galleryWrapper.add(t.$gallerySets).redraw().removeClass("scaleUp").addClass("scaleDown"),t.$gallerySets.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){t.$galleryWrapper.hide().add(t.$gallerySets).removeClass("scale scaleDown"),t.$novaGallery.css({height:"auto",overflow:""}),s.hide(),t.$novaGallery.find("menu a").removeClass("active"),t.$gallerySets.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")})):"slide"===t.homescreenAnim?(t.$novaGallery.css({height:t.$novaGallery.height(),overflow:"hidden"}),t.$gallerySets.addClass("slide").css({display:"block",top:-t.$novaGallery.height()}),t.$galleryWrapper.fadeOut(600,function(){t.$gallerySets.transition({top:0},600,t.easing,function(){t.$gallerySets.removeClass("slide"),t.$novaGallery.css({height:"auto",overflow:""})}),s.hide(),t.$novaGallery.find("menu a").removeClass("active")})):t.$galleryWrapper.fadeOut(600,function(){t.$gallerySets.fadeIn(600),s.hide(),t.$novaGallery.find("menu a").removeClass("active")});else if("goFullscreen"===this.id)i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement?i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen():t.$novaGallery[0].requestFullscreen?t.$novaGallery[0].requestFullscreen():t.$novaGallery[0].mozRequestFullScreen?t.$novaGallery[0].mozRequestFullScreen():t.$novaGallery[0].webkitRequestFullscreen?t.$novaGallery[0].webkitRequestFullscreen():t.$novaGallery[0].msRequestFullscreen&&t.$novaGallery[0].msRequestFullscreen();else if(0!==a.closest("#filterButtons").length){if(a.hasClass("top"))return;var u,f;a.closest("ul").find("a").removeClass("active"),a.addClass("active"),d?"all"===d?(u=n,f=o):(u=n.filter("[data-type="+d+"]"),f=o.filter("[data-type="+d+"]")):h&&(u=n.filter(function(){return h in e(this).data("categories")?!0:void 0}),f=o.filter(function(){return h in e(this).data("categories")?!0:void 0})),t.$thumbGrid.css("overflow","hidden"),n.not(u).redraw().removeClass("filtered"),u.addClass("filtered"),t.$thumbGrid.children("ul").masonry("reload"),Modernizr.csstransitions?t.$thumbGrid.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){t.$thumbGrid.css("overflow","").off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")}):(n.not(u).animate({opacity:0},t.filterSpeed,function(){e(this).hide(),t.$thumbGrid.css("overflow","")}),u.show().animate({opacity:1},t.filterSpeed)),t.$fullGallery.find("ul").fadeOut(t.filterSpeed,function(){if(o.filter("li.filtered").eq(0).css("margin-left","0"),o.removeClass("filtered").hide(),f.addClass("filtered").show(),e(this).fadeIn(t.filterSpeed),t.$fwActiveItem.hasClass("filtered")){var i=f.length,l=f.index(t.$fwActiveItem);t.$fullGallery.find("p.slide-number").text(l+1+"/"+i),t.fwIndex=l}else f.eq(0).trigger("click");t.setThumbnailsSlider()})}else{var c=s.filter('[data-display="'+r+'"]');a.addClass("active").siblings().removeClass("active"),c.is(":hidden")&&("fullwidth"===r?(t.$fullGallery.addClass("hidden"),t.$novaGallery.parent().addClass("parentHideOverflow"),t.setFullwidthSize(),t.$novaGallery.parent().removeClass("parentHideOverflow"),t.$fullGallery.removeClass("hidden")):t.fwMeElem&&t.fwMeElem.pause(),s.filter(":visible").fadeOut(600,function(){c.fadeIn(600,function(){"fullwidth"===r&&"photo"!==t.$fwmedia.data("type")&&"youtube"!==t.fwMeElem.pluginType&&"vimeo"!==t.fwMeElem.pluginType&&t.fwplayer.setControlsSize()})}))}},overlayCreate:function(){var t=l,a=e(this).parent(),s=a.data("type"),n=a.data("id"),o=t.$thumbGrid.find("li.filtered").index(a),r=t.$files.eq(n),d=r.find("source");t.thumbIndex=o,t.$otitle[0].innerHTML=r.find("title").text(),t.$odescription[0].innerHTML=r.find("description").text();var h=t.$window.height()/2;t.$mask.css({height:e(i).height(),width:e(i).width()}).fadeIn(400,function(){if(t.$overlayLoader.css("top",h).show(),"photo"===s){t.msie&&(t.$overlay.css({visibility:"hidden",display:"block"}),t.$overlayContent.css({visibility:"hidden",display:"block"}));var i=e('<img src="'+d.text()+'" alt="" />').appendTo(t.$overlayContent);i[0].onload=function(){t.resizeImage(i[0],"thumbnails");var e=i[0].width,l=i[0].height;t.msie&&(t.$overlay.css({visibility:"visible",display:"none"}),t.$overlayContent.css({visibility:"visible",display:"none"})),t.overlayShow(e,l,h)}}else if("audio"===s){for(var l="<audio controls>",a="<audio controls",n=0,o=d.length;o>n;n++){var r=d.eq(n).text(),u=r.split(".").pop();"ogg"===u?l+='<source type="audio/ogg" src="'+r+'" />':"mp3"===u&&(l+='<source type="audio/mpeg" src="'+r+'" />',a+='type="audio/mpeg" src="'+r+'"></audio>')}l+="</audio>",t.$overlayContent.append(t.isSafari?a:l),t.$window.width()<=480?t.overlayShow(t.$window.width()-80,30,h):t.overlayShow(400,30,h)}else if("video"===s){var f=600,c=338;if(t.$window.width()<=680?(f=t.$window.width()-80,c=f*(338/600)):t.$window.height()<=418&&(c=t.$window.height()-80,f=c*(600/338)),-1!==d.eq(0).text().indexOf("youtube")){var m=d.eq(0).text().split("v=")[1],p=t.autoplay?"&autoplay=1":"",v='<iframe width="'+f+'" height="'+c+'" src="https://www.youtube.com/embed/'+m+"?hd=1&rel=0&enablejsapi=1"+p+'" frameborder="0" allowfullscreen></iframe>',y=t.$overlayContent.append(v).find("iframe");t.thumbMeElem={pluginType:"youtube",pause:function(){y[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}}}else if(-1!==d.eq(0).text().indexOf("vimeo")){var m=d.eq(0).text().split("/").pop(),w=t.autoplay?"&autoplay=1":"",g="https://player.vimeo.com/video/"+m,v='<iframe src="'+g+"?api=1"+w+'" width="'+f+'" height="'+c+'" frameborder="0" webkitAllowFullScreen allowFullScreen></iframe>',y=t.$overlayContent.append(v).find("iframe");t.thumbMeElem={pluginType:"vimeo",pause:function(){y[0].contentWindow.postMessage('{"method":"pause"}',g)}}}else{for(var v='<video controls width="'+f+'" height="'+c+'">',$='<video controls width="'+f+'" height="'+c+'"',n=0,o=d.length;o>n;n++){var r=d.eq(n).text(),u=r.split(".").pop();"mp4"===u?(v+='<source type="video/mp4" src="'+r+'" />',$+='type="video/mp4" src="'+r+'"></video>'):"webm"===u?v+='<source type="video/webm" src="'+r+'" />':"ogv"===u&&(v+='<source type="video/ogg" src="'+r+'" />')}v+="</video>",t.$overlayContent.append(t.isSafari?$:v)}t.overlayShow(f,c,h)}})},overlayShow:function(e,i,t){var a=l,s=a.$thumbGrid.find("li.filtered").length,n=a.$window.width(),o=480>=n?n-80:e,r=a.$overlay.find("div.details");a.$overlay.css({display:"block",visibility:"hidden",width:o}),a.$overlayContent.show();var d=r.is(":hidden")?0:r.height(),h=i+d+20,u=-(i+d+40)/2,f=480>=n?-a.$overlay.outerWidth()/2:-(e+40)/2;a.$overlayContent.hide(),0===a.thumbIndex?(a.$prevItem.hide(),a.$nextItem.show()):a.thumbIndex===s-1?(a.$prevItem.show(),a.$nextItem.hide()):(a.$prevItem.show(),a.$nextItem.show()),a.$overlayLoader.hide(),a.$overlay.css({display:"none",visibility:"visible",width:o,height:h,top:t,marginTop:u,marginLeft:f}).slideDown(600,function(){a.$overlayContent.fadeIn(400).find("audio,video").mediaelementplayer({audioWidth:e,videoWidth:e,videoHeight:i,hideVolumeOnTouchDevices:a.isAndroid,startVolume:a.storeVolume&&a.volume?a.volume:1,loop:a.loop,pauseOtherPlayers:!1,mode:!a.isChrome||a.isiOS||a.isAndroid?"auto":"shim",success:function(e,i,t){a.thumbMeElem=e,a.thumbPlayer=t,a.html5FS&&"native"===t.media.pluginType&&t.container.find("div.mejs-fullscreen-button").off("click"),a.ie9js&&IE7.recalc(),a.autoplay&&e.play(),a.isiOS&&e.addEventListener("loadedmetadata",function(){t.container.find("div.mejs-fullscreen-button").css("visibility","visible")},!1)}})})},overlayPrev:function(){var e=l;e.thumbIndex-1<0||(e.thumbPlayer&&e.thumbPlayer.remove(),e.$overlayContent.hide().children().not("div.details").remove(),e.$overlay.hide(),e.thumbMeElem&&(e.thumbMeElem=null,e.thumbPlayer=null,t.mejs.players=[]),e.$thumbGrid.find("li.filtered").eq(e.thumbIndex-1).children("a.showOverlay").trigger("click"))},overlayNext:function(){var e=l;e.thumbIndex+1!==e.itemnum&&(e.thumbPlayer&&e.thumbPlayer.remove(),e.$overlayContent.hide().children().not("div.details").remove(),e.$overlay.hide(),e.thumbMeElem&&(e.thumbMeElem=null,e.thumbPlayer=null,t.mejs.players=[]),e.$thumbGrid.find("li.filtered").eq(e.thumbIndex+1).children("a.showOverlay").trigger("click"))},overlayClose:function(){var e=l;e.$overlayContent.fadeOut(400,function(){e.$overlay.slideUp(600,function(){e.thumbPlayer&&e.thumbPlayer.remove(),e.$overlayContent.children().not("div.details").remove(),e.$mask.fadeOut(400),e.thumbMeElem&&(e.volume=e.thumbMeElem.volume,e.msie&&(e.thumbMeElem=null,e.thumbPlayer=null,t.mejs.players=[]))})})},resizeImage:function(i,t){if(i){var a=l;"fullwidth"!==t||a.$fullGallery.hasClass("hidden")||a.$fullGallery.is(":visible")||a.$fullGallery.addClass("hidden");var s="thumbnails"===t?a.$window.width()-120:a.$fwmedia.width()-40,n="thumbnails"===t?a.$window.height()-270:a.$fwmedia.height()-40,o=s/n,r=i.width/i.height,d=i.width,h=i.height;if("fullwidth"===t){var u=e(i);u.addClass("getSize"),a.msie&&(d=u.width(),h=u.height(),r=d/h)}"thumbnails"===t&&(s=0>s?a.$window.width()-40:s,50>n&&(a.$overlay.css({display:"block",visibility:"hidden"}),a.$overlayContent.show(),n=a.$window.height()-100-a.$overlay.find("div.details").height(),a.$overlayContent.hide(),a.$overlay.css({display:"none",visibility:"visible"})),n=a.$window.width()<=480||a.$window.height()<=360?a.$window.height()-80:n),"fullwidth"===t&&"audio"===a.$fwmedia.data("type")&&(n=a.$fwmedia.height()-70),(d>s||h>n)&&(r===o?(d=s,h=n):(d=n*r,h=n,d>s&&(d=s,h=s/r))),i.width=d,i.height=h,"fullwidth"===t&&(u.removeClass("getSize").css("audio"===a.$fwmedia.data("type")?{left:(a.$fwmedia.width()-d)/2,top:(a.$fwmedia.height()-30-h)/2}:{left:(a.$fwmedia.width()-d)/2,top:(a.$fwmedia.height()-h)/2}),a.$fullGallery.removeClass("hidden"))}},setFWItem:function(i){i&&i.originalEvent&&l.fwClock&&l.resetSlideshow();

var a,s=l,n=e(this),o=s.$fullGallery.find("li.filtered"),r=o.length,d=o.index(this),h=n.data("id"),u=n.data("type"),f=s.$files.eq(h),c=f.find("source"),m=s.$fullGallery.find("div.bottom-bar"),p=null;s.fwIndex=d,s.$fwActiveItem=n,n.addClass("active").siblings().removeClass("active"),s.fwMeElem&&(s.volume=s.fwMeElem.volume)&&s.fwMeElem.pause(),0===d?(s.$fullGallery.find("a.prev").addClass("disabled"),s.$fullGallery.find("a.next").removeClass("disabled")):d===r-1?(s.$fullGallery.find("a.prev").removeClass("disabled"),s.$fullGallery.find("a.next").addClass("disabled")):(s.$fullGallery.find("a.prev").removeClass("disabled"),s.$fullGallery.find("a.next").removeClass("disabled")),m.find("p.slide-number").text(d+1+"/"+r),m.find("p.title").html(f.find("title").text()),s.$fwOverlay.is(":visible")&&s.closeFWCaption(),s.$fwmedia.data("type",u),s.$fullGallery.find("p.title").attr("data-type",u);var v=function(){if(s.$fwmedia.empty(),t.mejs.players=[],s.fwMeElem=null,s.fwplayer=null,"photo"===u)p=new Image,p.src=c.text(),s.$fwmedia.append(p),a=function(){s.$fullGallery.find("a.resize").hasClass("collapsed")?s.resizeImage(s.$fwmedia.find("img")[0],"fullwidth"):s.setFullMediaSize(),s.showFWMedia()};else if("audio"===u){p=new Image,p.src=f.find("poster").text(),s.$fwmedia.append(p),a=function(){s.$fullGallery.find("a.resize").hasClass("collapsed")?s.resizeImage(s.$fwmedia.find("img")[0],"fullwidth"):s.setFullMediaSize(),s.showFWMedia()};for(var e='<audio controls width="100%">',i='<audio controls width="100%"',l=0,n=c.length;n>l;l++){var o=c.eq(l).text(),r=o.split(".").pop();"ogg"===r?e+='<source type="audio/ogg" src="'+o+'" />':"mp3"===r&&(e+='<source type="audio/mpeg" src="'+o+'" />',i+='type="audio/mpeg" src="'+o+'"></audio>')}e+="</audio>",s.$fwmedia.append(s.isSafari?i:e),s.setFWPlayer()}else if("video"===u)if(-1!==c.eq(0).text().indexOf("youtube")){var d=c.eq(0).text().split("v=")[1],h=s.autoplay?"&autoplay=0":"",m='<iframe width="640" height="360" src="https://www.youtube.com/embed/'+d+"?hd=1&rel=0&enablejsapi=1&wmode=transparent"+h+'" frameborder="0" allowfullscreen></iframe>',v=s.$fwmedia.append(m).find("iframe");s.fwMeElem={pluginType:"youtube",pause:function(){v[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")}},s.fwplayer={container:v},s.showFWMedia(),s.$fullGallery.find("a.resize").hasClass("collapsed")?s.shrinkVideo():s.setFullMediaSize()}else if(-1!==c.eq(0).text().indexOf("vimeo")){var d=c.eq(0).text().split("/").pop(),y=s.autoplay?"&autoplay=0":"",m='<iframe src="https://player.vimeo.com/video/'+d+"?api=1&wmode=transparent"+y+'" width="640" height="360" frameborder="0" webkitAllowFullScreen allowFullScreen></iframe>',w="https://player.vimeo.com/video/"+d,v=s.$fwmedia.append(m).find("iframe");s.fwMeElem={pluginType:"vimeo",pause:function(){v[0].contentWindow.postMessage('{"method":"pause"}',w)}},s.fwplayer={container:v},s.showFWMedia(),s.$fullGallery.find("a.resize").hasClass("collapsed")?s.shrinkVideo():s.setFullMediaSize()}else{for(var g=f.find("poster"),$=0!==g.length?' poster="'+g.text()+'"':"",m='<video preload="metadata"'+$+">",b='<video preload="metadata"'+$+" ",l=0,n=c.length;n>l;l++){var o=c.eq(l).text(),r=o.split(".").pop();"mp4"===r?(m+='<source type="video/mp4" src="'+o+'" />',b+='type="video/mp4" src="'+o+'"></video>'):"webm"===r?m+='<source type="video/webm" src="'+o+'" />':"ogv"===r&&(m+='<source type="video/ogg" src="'+o+'" />')}m+="</video>",s.$fwmedia.append(s.isSafari?b:m),s.$fullGallery.addClass("loading"),s.setFWPlayer()}if(p&&"video"!==u){p.complete||"complete"===p.readyState||4===p.readyState?a():(s.$fullGallery.addClass("loading"),p.onload=function(){a(),s.$fullGallery.removeClass("loading")});var C=f.find("link").text(),G="";C&&(G=s.options.newWindowLinks?'<a class="link" href="'+C+'" target="_blank"></a>':'<a class="link" href="'+C+'"></a>',s.$fwmedia.append(G))}s.preloadImgs()};s.fwItemTransition(v)},fwItemTransition:function(e){var i=l;"flip"===i.options.fullwidthItemTransition&&Modernizr.csstransforms3d?i.$fwmedia.css({transformOrigin:"center center"}).transition({scale:.5,opacity:0},i.fwmediaSpeed,i.easing,e):"slide"===i.options.fullwidthItemTransition&&Modernizr.csstransitions?i.$fwmedia.transition({x:-i.$fwmedia.width()},i.fwmediaSpeed,i.easing,e):i.$fwmedia.animate({opacity:0},i.fwmediaSpeed,e)},showFWMedia:function(){var e=l;"flip"===e.options.fullwidthItemTransition&&Modernizr.csstransforms3d?e.$fwmedia.css({opacity:1,transform:"scale(0.5) rotateX(90deg)",transformOrigin:"center 75%"}).transition({perspective:"600px",rotateX:"0deg",scale:1},2*e.fwmediaSpeed,e.easing):"slide"===e.options.fullwidthItemTransition&&Modernizr.csstransitions?e.$fwmedia.css({x:e.$fwmedia.width()}).transition({x:0},e.fwmediaSpeed,e.easing):e.$fwmedia.animate({opacity:1},e.fwmediaSpeed)},setFWPlayer:function(){var e,i=l;e=!i.isChrome||i.isiOS||i.isAndroid?i.isIE9&&"video"===i.$fwmedia.data("type")?"shim":"auto":"shim",i.$fullGallery.find("audio,video").mediaelementplayer({hideVolumeOnTouchDevices:i.isAndroid?!0:!1,startVolume:i.storeVolume&&i.volume?i.volume:1,loop:i.loop,pauseOtherPlayers:!1,mode:e,success:function(e,t,l){i.fwMeElem=e,i.fwplayer=l,i.ie9js&&IE7.recalc(),"video"===e.tagName.toLowerCase()&&(i.isiOS||i.isAndroid?(i.$fullGallery.removeClass("loading"),i.showFWMedia(),i.$fullGallery.find("a.resize").hasClass("collapsed")?i.shrinkVideo():i.setFullMediaSize(),l.container.css("opacity","1").find("div.mejs-poster").css("opacity","1")):e.addEventListener("loadedmetadata",function(){i.$fullGallery.removeClass("loading"),i.showFWMedia(),i.$fullGallery.find("a.resize").hasClass("collapsed")?i.shrinkVideo():i.setFullMediaSize(),l.container.css("opacity","1"),"native"!==l.media.pluginType&&l.container.find("div.mejs-poster").css("opacity","1")},!1),(i.html5FS||i.isOpera)&&"native"===l.media.pluginType&&l.container.find("div.mejs-fullscreen-button").off("click"),i.isiOS&&e.addEventListener("loadedmetadata",function(){l.container.find("div.mejs-fullscreen-button").css("visibility","visible")},!1))}})},setFullwidthSize:function(){var e=l,t=e.$fwmedia.data("type"),a=e.$fullGallery.find("p.title"),s="container"===e.displayType?e.$novaGallery.parent():e.$window;(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement)&&(s=e.$window),a.css({width:a.parent().width()-a.prev().outerWidth(!0)-a.next().outerWidth(!0)-parseInt(a.css("margin-left"),10)-20}),e.$fullGallery.css({height:s.height()-e.$novaGallery.find("menu").height()}),e.$fwmedia.height(e.$fullGallery.height()-e.$fullGallery.find("div.fwBottom").height()),"photo"!==t&&!e.fwplayer&&e.setFWPlayer(),e.setThumbnailsSlider(),e.$fullGallery.find("a.resize").hasClass("collapsed")?"video"===t?e.shrinkVideo():e.resizeImage(e.$fwmedia.find("img")[0],"fullwidth"):e.setFullMediaSize()},showFullwidthThumbs:function(){var i=l,t="video"===i.$fwmedia.data("type")?!0:!1,a=i.$fullGallery.find("a.resize").hasClass("collapsed"),s=i.$fwmedia.find("img"),n=!t||"flash"!==i.fwMeElem.pluginType&&"youtube"!==i.fwMeElem.pluginType&&"vimeo"!==i.fwMeElem.pluginType?!1:!0;if(e(this).hasClass("active"))i.$fwmedia.animate({height:i.$fullGallery.height()-i.$fullGallery.find("div.bottom-bar").height()},{duration:600,step:function(e){n||(a?i.resizeImage(s[0],"fullwidth"):i.setFullMediaSize())},complete:function(){n&&(a?i.shrinkVideo():i.setFullMediaSize())}}),i.$fullGallery.find("div.thumbnails").transition({height:0},600,i.easing),e(this).removeClass("active");else{var o=i.$fullGallery.find("li").height(),r=i.$fullGallery.find("div.bottom-bar").height();i.$fullGallery.find("div.thumbnails").transition({height:o},600,i.easing),i.$fwmedia.animate({height:i.$fullGallery.height()-o-r},{duration:600,step:function(e){n||(a?i.resizeImage(s[0],"fullwidth"):i.setFullMediaSize())},complete:function(){n&&(a?i.shrinkVideo():i.setFullMediaSize())}}),e(this).addClass("active")}},setFullMediaSize:function(){var e,i,t,a,s=l,n=s.$fwmedia.data("type"),o=s.$fwmedia.width(),r=s.$fwmedia.height();if("video"===n&&s.fwMeElem)s.$fwmedia.find("video").css({width:"",height:""}),a=s.fwMeElem.videoWidth&&-1!==s.fwMeElem.videoWidth?s.fwMeElem.videoWidth/s.fwMeElem.videoHeight:640/360;else{if(e=s.$fwmedia.find("img"),0===e.length)return;a=e[0].width/e[0].height}if(a>o/r?(i=r*a,t=r):(i=o,t=o/a),"video"===n&&s.fwMeElem)if("youtube"===s.fwMeElem.pluginType||"vimeo"===s.fwMeElem.pluginType?s.fwplayer.container.attr({width:o,height:r}):(s.fwMeElem.setVideoSize(i,t),s.fwplayer.setPlayerSize(o,r)),"native"!==s.fwMeElem.pluginType||s.isiOS||s.isAndroid){var d=s.$fwmedia.find("div.mejs-poster img");0!==d.length&&d.css({width:i,height:"auto"}).parent().css("line-height",""),s.fwplayer.container.css({top:"auto",left:"auto"})}else s.$fwmedia.find("div.mejs-mediaelement").css({top:(r-t)/2,left:(o-i)/2});else e[0].width=i,e[0].height=t,e.css({left:(o-i)/2,top:(r-t)/2});s.fwplayer&&s.fwplayer.setControlsSize&&s.fwplayer.setControlsSize()},showNextFWItem:function(e){e&&e.originalEvent&&l.fwClock&&l.resetSlideshow();var i,t,a=l,s=a.$fullGallery.find("li.filtered"),n=s.length,o=a.$fullGallery.width()-2*a.$fullGallery.find("a.slide-next").width(),r=s.width(),d=Math.floor(o/r);a.fwIndex!==n-1&&(i=Math.floor(a.fwIndex/d),t=Math.floor((a.fwIndex+1)/d),i!==t&&a.$fullGallery.find("a.slide-next").trigger("click"),s.eq(a.fwIndex+1).trigger("click"))},showPrevFWItem:function(e){e&&e.originalEvent&&l.fwClock&&l.resetSlideshow();var i,t,a=l,s=a.$fullGallery.find("li.filtered"),n=a.$fullGallery.width()-2*a.$fullGallery.find("a.slide-next").width(),o=s.width(),r=Math.floor(n/o);0!==a.fwIndex&&(i=Math.floor(a.fwIndex/r),t=Math.floor((a.fwIndex-1)/r),i!==t&&a.$fullGallery.find("a.slide-prev").trigger("click"),s.eq(a.fwIndex-1).trigger("click"))},FWSlideshow:function(){var i=l,t=e(this),a=i.$fullGallery.find("div.progress").stop().css("width","0");i.fwClock?(clearInterval(i.fwClock),i.fwClock=null,t.removeClass("pause")):(a.animate({width:"100%"},i.pauseTime+i.fwmediaSpeed,"linear"),i.fwClock=setInterval(function(){var e=i.$fullGallery.find("li.filtered"),t=e.length;i.fwIndex===t-1?(e.eq(0).trigger("click"),e.eq(0).transition({marginLeft:0},600),e.parent().prev("a.slide-prev").addClass("disabled").end().next("a.slide-next").removeClass("disabled")):i.showNextFWItem(),a.stop().css("width","0").animate({width:"100%"},i.pauseTime+i.fwmediaSpeed,"linear")},i.pauseTime+i.fwmediaSpeed),t.addClass("pause"))},resetSlideshow:function(){var e=l;e.fwClock&&(clearInterval(e.fwClock),e.fwClock=null,e.FWSlideshow())},resizeFWItem:function(){var e=l,i=e.$fullGallery.find("a.resize");i.hasClass("collapsed")?(e.setFullMediaSize(),i.removeClass("collapsed")):("video"===e.$fwmedia.data("type")?e.shrinkVideo():e.resizeImage(e.$fwmedia.find("img")[0],"fullwidth"),i.addClass("collapsed"))},shrinkVideo:function(){if(l.fwMeElem){var e=l,i=e.$fwmedia.width(),t=e.$fwmedia.height(),a=i/t,s=-1!==e.fwMeElem.videoWidth&&e.fwMeElem.videoWidth?e.fwMeElem.videoWidth:640,n=-1!==e.fwMeElem.videoHeight&&e.fwMeElem.videoHeight?e.fwMeElem.videoHeight:360,o=s/n;e.$fwmedia.find("video").css({width:"",height:""}),(s>i||n>t)&&(o===a?(s=i,n=t):(s=t*o,n=t,s>i&&(s=i,n=i/o)));var r=e.$fwmedia.find("div.mejs-poster img");"native"!==e.fwMeElem.pluginType||e.isiOS||e.isAndroid?("youtube"===e.fwMeElem.pluginType||"vimeo"===e.fwMeElem.pluginType?e.fwplayer.container.attr({width:s,height:n}):(e.fwMeElem.setVideoSize(s,n),e.fwplayer.setPlayerSize(s,n),e.fwplayer.setControlsSize()),0!==r.length&&r.css({width:s,height:"auto"}).parent().css("line-height",n+"px"),e.fwplayer.container.css({top:(t-n)/2,left:(i-s)/2})):(e.fwMeElem.setVideoSize(s,n),e.fwplayer.setPlayerSize(i,t),e.fwplayer.setControlsSize(),e.$fwmedia.find("div.mejs-mediaelement").css({top:(t-n)/2,left:(i-s)/2}))}},showFWCaption:function(){{var e,i,t,a,s=l,n=s.$fwActiveItem.data("id"),o=s.$files.eq(n);"container"===s.options.displayType?s.$novaGallery.parent():s.$window}s.$fwOverlay.is(":visible")||(s.$fwOverlayContent.html("<h2></h2><p></p>").find("h2").html(o.find("title").text()).end().find("p").html(o.find("description").text()),s.$fwOverlay.addClass("hidden"),s.$fwOverlayContent.css("max-height",s.$fwmedia.height()-40),e=s.$fwOverlay.outerWidth(),i=s.$fwOverlay.outerHeight(),s.$fwOverlay.removeClass("hidden"),t=s.$fwmedia.height()/2-i/2,a=s.$fwmedia.width()/2-e/2,s.$fwOverlay.css({top:t-100,left:a,display:"block",opacity:0}).transition({top:t+s.$novaGallery.find("menu").height(),opacity:1},600,s.easing))},closeFWCaption:function(){var e=l;e.$fwOverlay.transition({top:"-=100px",opacity:0},600,e.easing,function(){e.$fwOverlay.hide(),e.$fwOverlayContent.empty()})},setThumbnailsSlider:function(){var e,i=l,t=i.$fullGallery.find("ul"),a=t.find("li.filtered"),s=a.length,n=i.$fullGallery.width()-2*i.$fullGallery.find("a.slide-next").width(),o=a.width(),r=a.index(a.filter("li.active")),d=0,h=0;e=Math.floor(n/o),d=-Math.floor((r+1)/e)*o*e,h=Math.ceil(s/e),t.width(o*e),t.data("slides",h),a.eq(0).css("margin-left",d),0===d?(t.prev("a.slide-prev").addClass("disabled"),t.next("a.slide-next").removeClass("disabled")):d===-h*t.width()?(t.prev("a.slide-prev").removeClass("disabled"),t.next("a.slide-next").addClass("disabled")):(t.prev("a.slide-prev").removeClass("disabled"),t.next("a.slide-next").removeClass("disabled")),1===h?t.addClass("centerItems").next("a.slide-next").addClass("disabled"):t.removeClass("centerItems")},thumbnailsSlideNext:function(){var i=l,t=e(this),a=i.$fullGallery.find("ul"),s=a.find("li.filtered");t.hasClass("disabled")||(t.siblings("a.slide-prev").removeClass("disabled"),s.eq(0).transition({marginLeft:"-="+a.width()},600,i.easing,function(){parseInt(s.eq(0).css("margin-left"),10)===-(a.data("slides")-1)*a.width()&&t.addClass("disabled")}))},thumbnailsSlidePrev:function(){var i=l,t=e(this),a=i.$fullGallery.find("ul"),s=a.find("li.filtered");t.hasClass("disabled")||(t.siblings("a.slide-next").removeClass("disabled"),s.eq(0).transition({marginLeft:"+="+a.width()},600,i.easing,function(){0===parseInt(s.eq(0).css("margin-left"),10)&&t.addClass("disabled")}))},touchSlide:function(e){var i=l;if("touchstart"===e.type)i.touchStartPos=e.originalEvent.touches[0].pageX;else if("touchmove"===e.type)e.preventDefault(),i.touchEndPos=e.originalEvent.touches[0].pageX;else if("touchend"===e.type){if(!i.touchEndPos)return;i.touchEndPos-i.touchStartPos>=100?i.$fullGallery.find("a.slide-prev").trigger("click"):i.touchEndPos-i.touchStartPos<=-100&&i.$fullGallery.find("a.slide-next").trigger("click"),i.touchEndPos=null}},preloadImgs:function(){for(var e=l,i=e.$fwActiveItem.data("id"),t=e.$files.eq(i),a=t.next(),s="",n=e.preloadNumber?e.preloadNumber:3,o=0;n>o;o++){var r=new Image;s=a.attr("type"),"photo"===s?r.src=a.find("source").text():"audio"===s?r.src=a.find("poster").text():"video"===s&&(r.src=a.find("poster").text()),a=a.next()}},handleKeys:function(e){var i=e.keyCode||e.charCode,t=l;t.$fullGallery.is(":visible")?39===i?(t.fwClock&&t.resetSlideshow(),t.showNextFWItem()):37===i?(t.fwClock&&t.resetSlideshow(),t.showPrevFWItem()):27===i&&t.closeFWCaption():t.$thumbGrid.is(":visible")&&t.$overlay.is(":visible")&&(39===i?t.overlayNext():37===i?t.overlayPrev():27===i&&t.overlayClose())},operaMEFS:function(){var i=l;"native"===i.fwplayer.media.pluginType&&(i.fwplayer.container.hasClass("mejs-container-fullscreen")?(i.fwplayer.container.removeClass("mejs-container-fullscreen"),e(this).addClass("mejs-fullscreen").removeClass("mejs-unfullscreen"),i.$fullGallery.css("overflow","hidden"),i.$fwmedia.css("overflow","hidden")):(i.fwplayer.container.addClass("mejs-container-fullscreen"),e(this).removeClass("mejs-fullscreen").addClass("mejs-unfullscreen"),i.$fullGallery.css("overflow","visible"),i.$fwmedia.css("overflow","visible")))},operaEscPlayerFS:function(e){var i=e.keyCode||e.charCode,t=l;27===i&&"native"===t.fwplayer.media.pluginType&&t.fwplayer.container.hasClass("mejs-container-fullscreen")&&(t.fwplayer.container.removeClass("mejs-container-fullscreen").find("div.mejs-fullscreen-button").addClass("mejs-fullscreen").removeClass("mejs-unfullscreen"),t.$fullGallery.find("div.fwBottom").show(),t.$novaGallery.find("menu").show(),t.$fullGallery.css("overflow","hidden"),t.$fwmedia.css("overflow","hidden"))},nativeMEFS:function(){var t=l,a=i.fullscreenElement?i.fullscreenElement:i.mozFullScreenElement?i.mozFullScreenElement:i.webkitFullscreenElement?i.webkitFullscreenElement:i.msFullscreenElement?i.msFullscreenElement:null,s=t.$thumbGrid.is(":visible")?"thumbnails":"fullwidth";a&&e(a).hasClass("mejs-video")?"thumbnails"===s?t.thumbPlayer.exitFullScreen():t.fwplayer.exitFullScreen():"thumbnails"===s?t.thumbPlayer.enterFullScreen():t.fwplayer.enterFullScreen()},getHiddenProp:function(){var e=["webkit","moz","ms","o"];if("hidden"in i)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in i)return e[t]+"Hidden";return null},isPageHidden:function(){var e=l.getHiddenProp();return e?i[e]:!1},pageVisChange:function(){var e=l;e.isPageHidden()&&(e.fwClock&&(clearInterval(e.fwClock),e.fwClock=null,e.$fullGallery.find("a.slideshow").removeClass("pause"),e.$fullGallery.find("div.progress").stop().css("width","0")),e.fwMeElem&&e.fwMeElem.pause(),e.thumbMeElem&&e.thumbMeElem.pause())},ngLog:function(){t.console&&t.console.log?console.log("[novaGallery] "+Array.prototype.slice.call(arguments)):alert("[novaGallery] "+Array.prototype.slice.call(arguments).join("<br>"))}};e.novaGallery=function(i){l.options=e.extend(!0,{},e.novaGallery.defaults,i);var t=e("#novaGallery"),a=l.options;if(!e.data(t[0],"novaGallery"))if(e.data(t[0],"novaGallery",!0),a.flickr)e("#filterButtons").hide(),"collection"===a.flickrOptions.sourceType?l.loadFlickrCollection(a.flickrOptions):l.loadFlickrData(a.flickrOptions);else if(a.picasa)e("#filterButtons").hide(),l.loadPicasaData(a.picasaOptions);else{var s=a.configUrl;a.detectMobile?e.ajax({type:"GET",url:novaGalleryParams.pluginUrl+"includes/mobile.php",dataType:"text",success:function(e){"true"===e&&(s=a.mobileConfigUrl),l.loadConfig(s)}}):l.loadConfig(s)}},e.novaGallery.defaults={autoplay:!0,loop:!1,storeVolume:!0,startMode:"thumbnails",fullwidthResize:!1,showFullwidthThumbs:!0,thumbnailsAppearAnimation:"fadeSeq",thumbnailsCaptionAnimation:"flip",alwaysShowThumbTitle:!1,fullwidthItemTransition:"fade",homescreenAnimation:"scale",displayType:"window",newWindowLinks:!0,useYoutubeThumbs:!0,useVimeoThumbs:!0,shuffleItems:!0,preloadNumber:5,slideshow:!1,pauseTime:5e3,stopSlideshowOnPageHide:!0,configUrl:"config-new.xml",detectMobile:!1,mobileConfigUrl:"config-mobile.xml",enableCache:!0,cacheFolder:"cache",cacheInterval:10,flickr:!1,flickrOptions:{apiKey:"2a2ce06c15780ebeb0b706650fc890b2",sourceType:"collection",sourceId:"72157600155564656",userId:"53074617@N00",limit:30,numberOfAlbums:"all",sort:"relevance",thumbSize:"s",imageSize:"l"},picasa:!1,picasaOptions:{sourceType:"collection",username:"112912962954236525225",album:"CanadianRockies",search:"europe",numberOfAlbums:"all",limit:30,thumbSize:288,imageSize:1280}},e.fn.redraw=function(){return this.each(function(){this.offsetHeight})}}(jQuery,document,window);